su -c "rmmod CDD2; rm -fr /dev/CDD2;"
make -C /lib/modules/4.9.3-2470-126-042mlm/build M=/root/hwk/Chapter_99/Examples/1 modules
make[1]: Entering directory '/usr/src/linux-4.9.3'
  CC [M]  /root/hwk/Chapter_99/Examples/1/main.o
  CC [M]  /root/hwk/Chapter_99/Examples/1/basic_ops.o
  CC [M]  /root/hwk/Chapter_99/Examples/1/proc_ops.o
  LD [M]  /root/hwk/Chapter_99/Examples/1/CDD2.o
  Building modules, stage 2.
  MODPOST 1 modules
  CC      /root/hwk/Chapter_99/Examples/1/CDD2.mod.o
  LD [M]  /root/hwk/Chapter_99/Examples/1/CDD2.ko
make[1]: Leaving directory '/usr/src/linux-4.9.3'
su -c "{ insmod ./CDD2.ko CDDparm=35;} || \
	{ echo CDDparm is not set;} ";
su -c "mknod -m 666 /dev/CDD2 c  35  0;"
gcc -o CDD2app CDD2app.c;
# @ [ -c /dev/CDD2 ] && { echo "Hello World" > /dev/CDD2;};
# @ [ -c /dev/CDD2 ] && { cat < /dev/CDD2; };
# @ [ -c /dev/CDD2 ] && { echo "Hello World" > /dev/CDD2;};
# @ [ -c /dev/CDD2 ] && { echo "Hello World" > /dev/CDD2;};
# @ [ -c /dev/CDD2 ] && { cat < /dev/CDD2; };
# Test file O_TRUNC mode
echo "Hello World" > /dev/CDD2;
cat < /proc/CDD/myCDD2;
Mode: Readable
Group Number: 42
Team Members: Mike Mehr, Team Member #2
Buffer Length - Allocated: 4096
Buffer Length - Used: 12
cat < /dev/CDD2;
Hello World
# Test file O_APPEND mode
echo -n "Testing" > /dev/CDD2;
echo ", 1, 2, 3 ..." >> /dev/CDD2;
cat < /proc/CDD/myCDD2;
Mode: Readable
Group Number: 42
Team Members: Mike Mehr, Team Member #2
Buffer Length - Allocated: 4096
Buffer Length - Used: 21
cat < /dev/CDD2;
Testing, 1, 2, 3 ...
# Test buffer overrun
yes | dd bs=1 count=5000 of=/dev/CDD2
Makefile:14: recipe for target 'run' failed
cat < /proc/CDD/myCDD2;
Mode: Readable
Group Number: 42
Team Members: Mike Mehr, Team Member #2
Buffer Length - Allocated: 4096
Buffer Length - Used: 4096
cat < /dev/CDD2 > /dev/null;
# test empty buffer
echo -n "" > /dev/CDD2
cat < /proc/CDD/myCDD2;
Mode: Readable
Group Number: 42
Team Members: Mike Mehr, Team Member #2
Buffer Length - Allocated: 4096
Buffer Length - Used: 0
cat < /dev/CDD2;
# run test app
./CDD2app;
Eureka!Hello World 13049872138472130984721398749832174.
a!
# Test writable proc entry
cat < /proc/CDD/myCDD2;
Mode: Readable
Group Number: 42
Team Members: Mike Mehr, Team Member #2
Buffer Length - Allocated: 4096
Buffer Length - Used: 55
echo "My Word!" > /proc/CDD/myCDD2;
cat < /proc/CDD/myCDD2;
Mode: Written
Group Number: 42
Team Members: Mike Mehr, My Word!
Buffer Length - Allocated: 4096
Buffer Length - Used: 55
cat < /proc/CDD/myCDD2;
Mode: Readable
Group Number: 42
Team Members: Mike Mehr, My Word!
Buffer Length - Allocated: 4096
Buffer Length - Used: 55
# show devfs and procfs entries created
ls -l /proc/CDD/myCDD2 /dev/CDD2
crw-rw-rw- 1 root root 35, 0 Feb 17 15:21 /dev/CDD2
-rwxrwxrwx 1 root root     0 Feb 17 15:21 /proc/CDD/myCDD2
